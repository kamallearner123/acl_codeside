{% extends 'base.html' %}
{% load static %}

{% block title %}Portfolio - Apt Computing Labs{% endblock %}

{% block content %}
<style>
    /* Portfolio Tabs */
    .portfolio-nav-wrapper {
        background: #ffffff;
        padding: 10px 0;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
    }
    .portfolio-tabs {
        border-bottom: none;
    }
    .portfolio-tabs .nav-link {
        color: #2d3748;
        font-weight: 600;
        padding: 10px 20px;
        border-radius: 8px;
        transition: all 0.3s;
        margin: 0 5px;
    }
    .portfolio-tabs .nav-link:hover {
        background-color: #e2e8f0;
        color: #1a3c6d;
    }
    .portfolio-tabs .nav-link.active {
        background: linear-gradient(135deg, #007bff, #00d4ff);
        color: #ffffff;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    /* Hero Section */
    .hero {
        background: linear-gradient(135deg, #1a3c6d, #2b6cb0);
        border-radius: 12px;
        padding: 40px;
        color: #ffffff;
        position: relative;
        overflow: hidden;
    }
    .hero-overlay::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('{% static 'img/hero-pattern.png' %}') no-repeat center/cover;
        opacity: 0.1;
        z-index: 0;
    }
    .hero > * {
        position: relative;
        z-index: 1;
    }
    .accent-pill {
        background-color: #28a745;
        color: #ffffff;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 500;
    }
    .accent-heading {
        font-weight: 700;
        font-size: 2.5rem;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
    }
    .cta .btn {
        border-radius: 25px;
        padding: 12px 30px;
        font-weight: 600;
        transition: all 0.3s;
    }
    .cta .btn-primary {
        background-color: #007bff;
        border: none;
    }
    .cta .btn-primary:hover {
        background-color: #0056b3;
    }
    .cta .btn-outline-light {
        border-color: #ffffff;
        color: #ffffff;
    }
    .cta .btn-outline-light:hover {
        background-color: #ffffff;
        color: #2b6cb0;
    }
    /* Cards */
    .card {
        border: none;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s, box-shadow 0.3s;
    }
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
    }
    .card-body {
        padding: 20px;
    }
    .card-title {
        color: #1a3c6d;
        font-weight: 600;
        font-size: 1.5rem;
    }
    .muted {
        color: #6b7280;
        font-size: 1rem;
    }
    .card img {
        border-radius: 8px;
    }
    /* Live Coding Section */
    .jumbotron {
        background: linear-gradient(135deg, #007bff, #00d4ff);
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    .jumbotron .display-4 {
        font-size: 2.5rem;
        font-weight: 700;
    }
    .jumbotron .lead {
        font-size: 1.2rem;
        color: #e2e8f0;
    }
    .jumbotron hr {
        border-color: #ffffff;
        opacity: 0.5;
    }
    .form-select {
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        padding: 8px;
    }
    .btn-light, .btn-outline-light {
        border-radius: 25px;
        padding: 10px 20px;
        font-weight: 600;
    }
    /* Stats Cards */
    .card .fa-3x {
        color: #007bff;
    }
    .card h2 {
        font-weight: 700;
        color: #1a3c6d;
    }
    /* Responsive Adjustments */
    @media (max-width: 768px) {
        .accent-heading {
            font-size: 2rem;
        }
        .jumbotron {
            flex-direction: column;
            text-align: center;
        }
        .jumbotron .display-4 {
            font-size: 2rem;
        }
        .portfolio-tabs .nav-link {
            padding: 8px 15px;
            font-size: 0.9rem;
        }
    }
</style>

<div class="container py-4">
    <div class="d-flex justify-content-center align-items-center mb-3">
        <div class="portfolio-nav-wrapper w-100">
            <nav class="d-flex justify-content-center">
                <ul class="nav nav-tabs portfolio-tabs" id="portfolioTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="about-tab" data-bs-toggle="tab" data-bs-target="#about" type="button" role="tab">About</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="courses-tab" data-bs-toggle="tab" data-bs-target="#courses" type="button" role="tab">Courses</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="livecoding-tab" data-bs-toggle="tab" data-bs-target="#livecoding" type="button" role="tab">Live Coding</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="events-tab" data-bs-toggle="tab" data-bs-target="#events" type="button" role="tab">Events</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="solutions-tab" data-bs-toggle="tab" data-bs-target="#solutions" type="button" role="tab">Solutions</button>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="tab-content" id="portfolioTabsContent">
        <div class="tab-pane fade show active" id="about" role="tabpanel" aria-labelledby="about-tab">
            <div class="mb-4">
                <div class="hero mb-4 hero-overlay">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <span class="accent-pill">Secure • Observability • AI</span>
                                <h1 class="mt-3 accent-heading">Building Secure Software Systems with People-First Training</h1>
                                <p class="lead">We empower teams to adopt memory-safe languages like Rust, implement Zero Trust architectures, and leverage Agentic AI to automate security tasks—ensuring safer products and more productive teams.</p>
                                <div class="cta">
                                    <a class="btn btn-lg btn-primary me-2" href="{% url 'courses:list' %}">View Courses</a>
                                    <a class="btn btn-lg btn-outline-light" data-bs-toggle="modal" data-bs-target="#contactModal">Contact Us</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row gx-4">
                    <div class="col-lg-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">Secure Coding Empowerment</h5>
                                <p class="muted">Guiding teams to adopt memory-safe languages like Rust and secure coding best practices.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">Zero Trust & Observability</h5>
                                <p class="muted">Deploy observability on Linux platforms and implement Zero Trust patterns to reduce breach impact.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">Agentic AI & Automation</h5>
                                <p class="muted">Use Agentic AI to streamline secure development workflows and automate repetitive tasks.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4 gx-4">
                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body d-flex gap-3 align-items-start">
                                <div style="width:140px;flex:0 0 140px;">
                                    <img src="{% static 'img/kamal.png' %}" alt="Kamal Kumar Mukiri" class="img-fluid rounded">
                                    <div class="mt-2 text-center"><small class="text-muted">Founder</small></div>
                                </div>
                                <div>
                                    <h5 class="mb-1">Kamal Kumar Mukiri — Founder</h5>
                                    <p class="mb-0">Software engineer with 17 years' experience in system programming, network security, and embedded systems. Trainer and consultant in secure engineering practices.</p>
                                    <div class="mt-2">
                                        <a href="mailto:info@aptcomputinglabs.com" class="btn btn-sm btn-outline-primary">Contact</a>
                                        <a href="https://www.linkedin.com/groups/11816027/" target="_blank" class="btn btn-sm btn-outline-secondary ms-2">LinkedIn</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h6>Contact</h6>
                                <p class="mb-1"><strong>Email:</strong><br> info@aptcomputinglabs.com</p>
                                <p class="mb-1"><strong>Phone:</strong><br> +91 9739858111</p>
                                <a href="https://www.linkedin.com/groups/11816027/" target="_blank" class="btn btn-sm btn-outline-secondary mt-2">LinkedIn Group</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="courses" role="tabpanel" aria-labelledby="courses-tab">
            {% include 'courses/_list_content.html' %}
        </div>

        <div class="tab-pane fade" id="livecoding" role="tabpanel" aria-labelledby="livecoding-tab">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="jumbotron bg-primary text-white p-5 rounded d-flex justify-content-between align-items-center">
                        <div>
                            <h1 class="display-4">Enjoy Live Coding</h1>
                            <p class="lead">Practice Python and Rust programming with challenging coding problems.</p>
                            <hr class="my-2">
                            <p>Sharpen your coding skills with our collection of programming challenges. Track your progress and enhance your problem-solving abilities.</p>
                        </div>
                        <div>
                            <div class="mb-3">
                                <label for="langSelect" class="form-label text-white mb-2">Choose Language</label>
                                <select id="langSelect" class="form-select form-select-sm" style="width:140px;">
                                    <option value="python" selected>Python</option>
                                    <option value="rust">Rust</option>
                                </select>
                            </div>
                            {% if not user.is_authenticated %}
                                <a class="btn btn-light btn-lg mb-2 w-100" href="{% url 'accounts:register' %}" role="button">
                                    <i class="fas fa-user-plus"></i> Get Started
                                </a>
                                <a class="btn btn-outline-light btn-lg mt-2 w-100" href="{% url 'accounts:login' %}" role="button">
                                    <i class="fas fa-sign-in-alt"></i> Login
                                </a>
                            {% else %}
                                <a id="startCodingBtn" class="btn btn-light btn-lg mb-2 w-100" href="#" role="button" data-base-url="{% url 'questions:list' %}">
                                    <i class="fas fa-code"></i> Start Coding
                                </a>
                                <form method="post" action="{% url 'accounts:logout' %}">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-outline-light btn-lg mt-2 w-100">
                                        <i class="fas fa-sign-out-alt"></i> Logout
                                    </button>
                                </form>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            {% if user.is_authenticated %}
            <div class="row mt-5">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body text-center">
                            <i class="fas fa-trophy fa-3x text-warning mb-3"></i>
                            <h5 class="card-title">Problems Solved</h5>
                            <h2 class="text-primary">{{ user.profile.problems_solved }}</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body text-center">
                            <i class="fas fa-chart-line fa-3x text-success mb-3"></i>
                            <h5 class="card-title">Total Submissions</h5>
                            <h2 class="text-primary">{{ user.profile.total_submissions }}</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body text-center">
                            <i class="fas fa-percentage fa-3x text-info mb-3"></i>
                            <h5 class="card-title">Acceptance Rate</h5>
                            <h2 class="text-primary">{{ user.profile.acceptance_rate }}%</h2>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
            <div class="mt-4">
                <p>Developer tools: <a href="{% url 'devtools:list' %}" class="btn btn-sm btn-outline-primary">Browse Developer Tools</a></p>
            </div>
        </div>

        <div class="tab-pane fade" id="events" role="tabpanel" aria-labelledby="events-tab">
            <div class="card mb-4">
                <div class="card-body">
                    <h2 class="h5 mb-4">
                        <i class="fas fa-calendar-alt me-2"></i>Recent Events
                    </h2>
                    
                    <!-- Recent Workshop Event -->
                    <div class="event-card mb-4">
                        <div class="row g-4">
                            <div class="col-md-4">
                                <div class="event-image-container">
                                    <img src="{% static 'img/rust-vit-19-20-sept.png' %}" alt="Rust Programming Workshop at VIT" class="img-fluid rounded shadow">
                                    <div class="event-badge">
                                        <i class="fas fa-calendar me-1"></i>
                                        Sept 19-20, 2025
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="event-content">
                                    <h3 class="event-title">
                                        🌟 Rust Programming Workshop at Vishnu Institute of Technology
                                    </h3>
                                    <div class="event-meta mb-3">
                                        <span class="badge bg-primary me-2">
                                            <i class="fas fa-map-marker-alt me-1"></i>Bhimavaram
                                        </span>
                                        <span class="badge bg-success me-2">
                                            <i class="fas fa-clock me-1"></i>2 Days
                                        </span>
                                        <span class="badge bg-info">
                                            <i class="fab fa-rust me-1"></i>#RustProgramming
                                        </span>
                                    </div>
                                    
                                    <div class="event-description">
                                        <p><strong>Excited to share the success of my recent two-day workshop on Rust Programming!</strong> 🌟</p>
                                        
                                        <p>It was an incredible experience introducing engineers to the power of <strong>Rust</strong>—a language known for its memory safety, performance, and cargo features. The workshop aimed to equip participants with foundational skills in Rust programming, exploring its applications in systems development.</p>
                                        
                                        <div class="workshop-highlights">
                                            <h6 class="text-primary mb-2">
                                                <i class="fas fa-code me-2"></i>Workshop Coverage:
                                            </h6>
                                            <ul class="list-unstyled">
                                                <li><i class="fas fa-check text-success me-2"></i>Need of Secure programming language in present world</li>
                                                <li><i class="fas fa-check text-success me-2"></i>Core Rust concepts: <strong>#ownership, #borrowing, #lifetimes</strong></li>
                                                <li><i class="fas fa-check text-success me-2"></i>Advanced topics: <strong>#traits, #crates, #structs, #collections</strong></li>
                                                <li><i class="fas fa-check text-success me-2"></i>Hands-on coding sessions and practical implementations</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="acknowledgments mt-3 p-3 bg-light rounded">
                                            <p class="mb-2"><strong>🙏 Acknowledgments:</strong></p>
                                            <p class="mb-1">A huge thank you to the enthusiastic students and faculty at <strong>Vishnu Institute of Technology</strong> for their active participation and insightful questions.</p>
                                            <p class="mb-0">Special appreciation to <strong>#Prof Ratna Babu M</strong> for referring me to this event as trainer.</p>
                                        </div>
                                        
                                        <div class="mt-3">
                                            <p class="text-muted mb-0"><em>Looking forward to more opportunities to inspire and educate through tech workshops! 🚀</em></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-4">
                        <p class="text-muted">
                            <i class="fas fa-info-circle me-2"></i>
                            Interested in hosting a workshop at your institution? 
                            <a href="#contact" class="text-primary">Contact us</a> for more information.
                        </p>
                    </div>
                </div>
            </div>
            
            <style>
                .event-card {
                    border: 1px solid #e9ecef;
                    border-radius: 12px;
                    padding: 1.5rem;
                    background: #fff;
                    transition: all 0.3s ease;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                }
                
                .event-card:hover {
                    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                    transform: translateY(-2px);
                }
                
                .event-image-container {
                    position: relative;
                }
                
                .event-image-container img {
                    width: 100%;
                    height: 250px;
                    object-fit: cover;
                    border-radius: 8px;
                }
                
                .event-badge {
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    background: rgba(0, 123, 255, 0.9);
                    color: white;
                    padding: 5px 10px;
                    border-radius: 15px;
                    font-size: 0.8rem;
                    font-weight: 600;
                }
                
                .event-title {
                    color: #2c3e50;
                    font-size: 1.4rem;
                    font-weight: 600;
                    margin-bottom: 1rem;
                    line-height: 1.3;
                }
                
                .event-meta .badge {
                    font-size: 0.8rem;
                    padding: 6px 10px;
                }
                
                .event-description {
                    color: #495057;
                    line-height: 1.6;
                }
                
                .workshop-highlights {
                    background: #f8f9fa;
                    padding: 1rem;
                    border-radius: 8px;
                    margin: 1rem 0;
                    border-left: 4px solid #007bff;
                }
                
                .workshop-highlights ul li {
                    padding: 0.25rem 0;
                }
                
                .acknowledgments {
                    border-left: 4px solid #28a745;
                }
                
                @media (max-width: 768px) {
                    .event-image-container img {
                        height: 200px;
                    }
                    
                    .event-title {
                        font-size: 1.2rem;
                    }
                    
                    .event-meta {
                        text-align: center;
                    }
                    
                    .event-meta .badge {
                        display: inline-block;
                        margin: 0.2rem;
                    }
                }
            </style>
        </div>

        <div class="tab-pane fade" id="solutions" role="tabpanel" aria-labelledby="solutions-tab">
            <div class="card mb-4">
                <div class="card-body">
                    <h2 class="h5">Solutions</h2>
                    <p>Community-submitted solutions and editorial content will go here.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Contact Modal -->
<div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="contactModalLabel">Contact Us</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="contactForm" method="post" action="{% url 'contact:contact' %}">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="contactName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="contactName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="contactEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="contactEmail" name="email" required>
                    </div>
                    <div class="mb-3">
                        <label for="contactSubject" class="form-label">Subject</label>
                        <input type="text" class="form-control" id="contactSubject" name="subject" required>
                    </div>
                    <div class="mb-3">
                        <label for="contactMessage" class="form-label">Message</label>
                        <textarea class="form-control" id="contactMessage" name="message" rows="4" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Send</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
// Activate tab from URL hash (e.g., #livecoding)
document.addEventListener('DOMContentLoaded', function(){
    try {
        const hash = window.location.hash;
        if(hash){
            const triggerEl = document.querySelector(`button[data-bs-target="${hash}"]`);
            if(triggerEl){
                var tab = new bootstrap.Tab(triggerEl);
                tab.show();
            }
        }
    } catch (e){
        // ignore if bootstrap not available or errors in older browsers
    }

    // Wire Start Coding button to include language selection
    try {
        const startBtn = document.getElementById('startCodingBtn');
        const langSelect = document.getElementById('langSelect');
        if(startBtn && langSelect){
            startBtn.addEventListener('click', function(e){
                e.preventDefault();
                const base = startBtn.getAttribute('data-base-url') || '/questions/';
                const lang = encodeURIComponent(langSelect.value || 'python');
                window.location.href = `${base}?lang=${lang}`;
            });
        }
    } catch (e){}

    // Update URL hash when a tab is shown so deep-links reflect UI state
    try {
        const tabButtons = document.querySelectorAll('#portfolioTabs button[data-bs-toggle="tab"]');
        tabButtons.forEach(btn => {
            btn.addEventListener('shown.bs.tab', function (evt) {
                try {
                    const target = btn.getAttribute('data-bs-target');
                    if(history && history.replaceState){
                        history.replaceState(null, '', target);
                    } else {
                        window.location.hash = target;
                    }
                } catch (e){}
            });
        });
    } catch (e){}
});
</script>
{% endblock %}